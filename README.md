# EMG Data Augmentation System (肌电数据批量扩容与处理工具)

![Python](https://img.shields.io/badge/Python-3.10+-blue.svg)
![License](https://img.shields.io/badge/License-MIT-green.svg)
![Release](https://img.shields.io/badge/Release-v2.8-orange.svg)

## 📖 项目简介 (Overview)

本项目是一个专门针对 **肌电图 (EMG)** 及其他生物力学时间序列数据的批量自动化扩容与格式转换工具。在深度学习应用于意图识别、康复外骨骼机器人控制等领域时，往往面临有效受试者数据量不足的痛点。

本工具通过向原始特征数据中注入微小的高斯白噪声（Gaussian White Noise），模拟真实测试中传感器电噪声、电极片微小移位或肌肉疲劳状态的变化，能够快速、科学地将原始数据集（CSV 格式）扩容数十倍，并安全转换为多 Sheet 结构的 XLS 文件，以满足大模型训练的海量数据吞吐需求。

---

## ✨ 核心特性 (Key Features)

* **🤖 科学的数据增强算法**：自动识别数值型特征通道，注入符合生理信号特征的微小高斯噪声（$\mu=0, \sigma=0.01$），生成高度相似但具有泛化价值的“克隆样本”。
* **⏱️ 严格的时间轴对齐保护**：
  * 智能识别时间列（如 `Time_s`）并将其排除在噪声注入之外。
  * 自动计算原始数据的采样周期（$dt$），强制要求所有生成的数据时间轴严格单调递增，且基准点从 $0$ 开始。
* **📁 突破 XLS 物理极限的分片技术**：传统 `.xls` 格式单表最高仅支持 65,535 行。本系统内置智能分片引擎，对于几十万行的高采样率动态数据（Dynamic Testing），会自动将其安全切分为 `_p1`, `_p2` 等连续的 Sheet 页，拒绝数据截断丢失。
* **🖥️ 现代化的异步 GUI**：基于 `customtkinter` 打造，支持任意文件层级结构的自动扫描与 1:1 目录树重建。
* **⏸️ 线程安全级控制**：提供“暂停/恢复”与“安全取消”功能。取消任务时会立即清理内存残留，不会在磁盘中生成损坏的半成品文件。

---

## 🚀 快速开始 (Getting Started)

### 选项 A：免安装直接运行 (推荐终端用户)
无需配置任何 Python 环境，直接下载打包好的绿色版软件：
1. 访问本仓库的 **[Releases 页面]** (或在 `releases/` 目录下找到可执行文件)。
2. 下载 `EMG_Augmentation_Tool_v2.8.exe`。
3. 双击即可打开可视化界面使用。

### 选项 B：从源码运行 (针对二次开发者)

**1. 克隆代码仓库**
```bash
git clone [https://github.com/yuzhe12/csv-.git](https://github.com/yuzhe12/csv-.git)

**2. 配置Python环境（推荐使用Conda）**
conda create -n emg_env python=3.10
conda activate emg_env

**3. 安装依赖库**
pip install -r requirements.txt

**4. 启动主程序**
cd src
python app.py

## 📚 使用说明 (Usage Guide)
 * 输入路径：选择包含原始 .csv 数据的主文件夹。程序会自动向下递归扫描所有的 CSV 文件（自动跳过图片或无关文本）。
 * 输出路径：选择要保存数据的目标文件夹。程序会完美复刻输入目录的内部层级结构（例如 P01, P02...）。
 * 克隆倍数：设置你需要扩容的倍数（例如填入 20，则 1 份原数据将衍生出 20 份带有微小变化的克隆数据）。⚠️ 注意：倍数大于 50 时会触发内存警告，请确保您的电脑具有充足的 RAM。
 * 进度监控：系统提供“总体进度”与“单文件进度”双重显示，并实时反馈磁盘写入保存状态。

### 📊 数据输出结构释义
生成的 .xls 文件会包含多个工作表 (Sheet)，规范如下：
 * subject0：基准数据。即原始输入数据，但时间轴已被自动清洗并对齐至从 0 开始。
 * subject1 ~ subjectX：增强后的虚拟受试者数据。包含微小噪声，用于大幅扩充机器学习的训练集边界。

## ⚠️ 注意事项与局限性 (Limitations)
1. 内存占用 (RAM Usage)：本工具使用底层 xlwt 引擎构建 .xls 二进制文件。由于该引擎机制会将整个工作簿暂存在内存中统一写入，如果单文件极大（>5MB）且扩容倍数过高（>40），会占用极大内存。若发生内存溢出崩溃，请尝试降低克隆倍数或分批次运行
2. 时间轴识别规则：程序默认优先寻找名为 Time_s 的列作为时间轴进行锁定。如果没有该表头，则默认将第一列视为时间轴。请在使用前确保您的 CSV 数据格式规范

## 🛠️ 技术栈 (Tech Stack)
 * GUI 框架: CustomTkinter
 * 数据处理核心: Pandas, NumPy
 * Excel 底层引擎: xlwt

## 📄 许可证 (License)
本项目基于 MIT License 开源，允许自由用于学术研究及商业用途。欢迎各位同行提交 Pull Requests 或反馈 Issue！

祝您的外骨骼机器人与肌电控制研究顺利！